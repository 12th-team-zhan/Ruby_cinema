<%= render "shared/nav" %>
<div class="container text-center py-5 w-75 ">
  <div class="row align-items-start">
    <h2>快搜條件</h2>
    <div class="d-flex" data-controller="search-showtime-by-area">
      <div class="col-10 d-flex">
        <div class="col">
          <div class="d-flex justify-content-around align-items-center">
            <div class="icon"><i class="m-0 fa-solid fa-location-dot  text-white"></i></div>
            <select class="form-select w-90" 
                        aria-label="select" 
                        data-action="change->search-showtime-by-area#addMovieList"
              data-search-showtime-by-area-target="area">
              <option>請選擇地區</option>
              <% @theater_areas.each do |theater_area| %>
                <option value="<%= theater_area[1] %>" ><%= theater_area[0] %></option>
              <% end %>
            </select>
          </div>
        </div>
        <div class="col">
          <div class="d-flex justify-content-around align-items-center">
            <div class="icon"><i class="m-0 fa-solid fa-video  text-white"></i></div>
            <select class="form-select w-90" 
                      aria-label="select"
                      data-search-showtime-by-area-target="movieList"
                      data-action="change->search-showtime-by-area#addShowtimeList">
              <option>請選擇電影</option>
            </select>
          </div>
        </div>
        <div class="col">
          <div class="d-flex">
            <div class="d-flex justify-content-around align-items-center col">
              <div class="icon"><i class="m-0 fa-regular fa-calendar-days text-white"></i></div>
              <select class="form-select w-90 col" 
                          aria-label="select"
                          data-search-showtime-by-area-target="showtimeList"
                          data-action="change->search-showtime-by-area#addTimeSelect">
                <option>請選擇日期</option>
              </select>
            </div>
          </div>
        </div>
        <div class="col">
          <div class="d-flex">
            <div class="d-flex justify-content-around align-items-center col">
              <div class="icon"><i class="m-0 fa-solid fa-location-dot  text-white"></i></div>
              <select class="form-select w-90 col" 
                          aria-label="select"
                          data-search-showtime-by-area-target="startTime">
                <option value="0">時段(起)</option>
              </select>
            </div>
            <div class="d-flex justify-content-around align-items-center col">
              <div class="icon"><i class="m-0 fa-solid fa-location-dot  text-white"></i></div>
              <select class="form-select w-90 col" 
                          aria-label="select"
                          data-search-showtime-by-area-target="endTime"
                          data-action="change->search-showtime-by-area#changeLink">
                <option value="0">時段(迄)</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <div class="col-2">
        <span class="my-2 py-1"
          data-action="click->search-showtime-by-area#checkAreaData">
          <%= link_to "查詢場次", "#", class: "btn btn-lg search-bottom", id: "rootSearchShowtime"%>
        </span>
      </div>
    </div>
  </div>
  <section class="py-5">
    <h2>快搜空位結果</h2>
    <h3><%= @movie.name %></h3>
    <article class="py-3">
      <% if (@movie.present? && @showtimes.present?) %>
        <table class="table">
          <thead class="table-primary">
            <th>影城</th>
            <th>日期</th>
            <th>開始時間</th>
            <th>前往購票</th>
          </thead>
          <% @showtimes.each do |showtime| %>
            <tbody>
              <td><%= showtime.cinema.theater.name%></td>
              <td><%= showtime.started_at.strftime("%Y-%m-%d") %></td>
              <td><%= showtime.started_at.strftime("%I:%M %p") %></td>
              <td><%= link_to "前往購票", "/ticketing/select_tickets?showtimeid=#{showtime.id}" %></td>
            </tbody>
          <% end %>
        </table>
      <% else %>
        <h3>查無場次</h3>
      <% end %>
    </article>
  </section>
</div>
